<div id="activity-log">
    <div data-ng-show="loading && !loaded">
        <template data-src="layout/loading"></template>
    </div>

    <div data-ng-show="loaded">
        <div class="row table-header">
            <div class="col-md-9">
                <h4>
                    User activity log

                    <span>({{itemCount}})</span>
                </h4>
            </div>

            <div class="col-md-3 pull-right">
                <list-search data-filters="filters"></list-search>
            </div>
        </div>

        <div class="data-loading"
            data-ng-show="loading"
        >
            <template data-src="layout/loading"></template>
        </div>

        <table class="table table-striped table-hover table-condensed"
            data-ng-class="{'loading-fade': loading}"
        >
            <thead>
                <tr>
                    <th class="text-nowrap"
                        data-ng-repeat="item in titleItems | filter: titleFilter"
                        data-ng-class="item.class"
                    >
                        <a
                            data-ng-show="item.sortable"
                            data-ng-click="changeSort(item)"
                            data-ng-class="{'text-muted': item.searchable && !item.inSearch}"
                            data-ng-bind-html="item.title"
                        ></a>

                        <span class="text-info"
                            data-ng-show="!item.sortable"
                            data-ng-class="{'text-muted': item.searchable && !item.inSearch}"
                            data-ng-bind-html="item.title"
                        ></span>

                        <i class="fa"
                            data-ng-show="sort.column == item.column"
                            data-ng-class="{'fa-angle-down': !sort.direction, 'fa-angle-up': sort.direction}"
                        ></i>
                    </th>
                </tr>
            </thead>
            <tbody class="text-small">
                <tr
                    data-ng-if="items.length == 0"
                >
                    <td colspan="100%" class="text-center text-medium text-muted">
                        <em>No activity log data...</em>
                    </td>
                </tr>
                <tr
                    data-ng-repeat="history in items"
                >
                    <td class="text-nowrap">
                        {{history.objectName}}
                    </td>
                    <td class="text-nowrap">
                        {{history.objectId}}
                    </td>
                    <td class="col-sm-12">
                        {{history.message}}
                    </td>
                    <td class="text-nowrap text-right">
                        <span id="qtip-trigger-object-data-{{history.id}}" class="text-info text-cursor"
                            data-qtip-options='{ "hide": { "delay": 200, "fixed": true } }'
                        >{{(history.objectData.length * 4)|sizeConverter:2}}</span>

                        <div
                            data-ng-if="history.id"
                            data-qtip
                            data-qtip-id="object-data-{{history.id}}"
                            data-class="json"
                            data-position="bottomRight"
                        >
                            <pre class="json"
                                data-json='history.objectData'
                                data-pretty-json
                            ></pre>
                        </div>
                    </td>
                    <td class="text-nowrap">
                        <timestamp data-stamp="{{history.createdAt}}"></timestamp>
                    </td>
                </tr>
            </tbody>
        </table>

        <pagination class="pagination-sm"
            data-total-items="itemCount"
            data-ng-model="currentPage"
            data-items-per-page="itemsPerPage"
            data-max-size="10"
            data-boundary-links="true"
            data-rotate="false"
        ></pagination>
    </div>
</div>