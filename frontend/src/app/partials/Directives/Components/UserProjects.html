<div>
    <div data-ng-show="loading && !loaded">
        <template data-src="layout/loading"></template>
    </div>

    <div data-ng-show="loaded">
        <div class="row table-header">
            <div class="col-md-9">
                <h4>
                    Projects involved with

                    <span>({{itemCount}})</span>
                </h4>
            </div>

            <div class="col-md-3 pull-right">
                <list-search data-filters="filters"></list-search>
            </div>
        </div>

        <div class="data-loading"
            data-ng-class="{'loading-fade': loading}"
            data-ng-show="loading"
        >
            <template data-src="layout/loading"></template>
        </div>

        <table class="table table-striped table-hover table-condensed"
            data-ng-class="{'loading-fade': loading}"
        >
            <thead>
                <tr>
                    <th>
                        <i id="qtip-trigger-add-new-project" class="fa fa-plus btn btn-default"></i>

                        <div
                            data-qtip
                            data-qtip-id="add-new-project"
                            data-position="leftMiddle"
                        >
                            Add new project
                        </div>
                    </th>

                    <th class="text-nowrap"
                        data-ng-repeat="item in titleItems | filter: titleFilter"
                    >
                        <a
                            data-ng-show="item.sortable"
                            data-ng-click="changeSort(item)"
                            data-ng-class="{'text-muted': item.searchable && !item.inSearch}"
                            data-ng-bind-html="item.title"
                        ></a>

                        <span class="text-info"
                            data-ng-show="!item.sortable"
                            data-ng-class="{'text-muted': item.searchable && !item.inSearch}"
                            data-ng-bind-html="item.title"
                        ></span>

                        <i class="fa"
                            data-ng-show="sort.column == item.column"
                            data-ng-class="{'fa-angle-down': !sort.direction, 'fa-angle-up': sort.direction}"
                        ></i>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr
                    data-ng-if="items.length == 0"
                >
                    <td colspan="6" class="text-center text-medium text-muted">
                        <em>No projects found...</em>
                    </td>
                </tr>
                <tr
                    data-ng-repeat="project in items"
                >
                    <td>
                        <div id="actionMenu_{{project.id}}"
                            data-action-menu
                        >
                            <ul class="action-menu">
                                <li>
                                    <a data-ng-click="openProjectEdit(project.id)">
                                        <i class="fa fa-wrench"></i>
                                        Edit project
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a class="text-danger"
                                        data-ng-click="deleteProject(project.id)"
                                    >
                                        <i class="fa fa-trash-o"></i>
                                        Delete project
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>
                    <td style="width: 100%">
                        {{project.title}}
                    </td>
                    <td class="text-nowrap">
                        {{getUserRole(project.projectUsers)}}
                    </td>
                    <td class="text-nowrap text-right">
                        {{project.projectUsers.length}}
                    </td>
                    <td class="text-nowrap text-right">
                        {{project.sprints.length}}
                    </td>
                    <td class="text-nowrap">
                        {{project.dateStart|amDateFormat:currentUser.momentFormatDate}} - {{project.dateEnd|amDateFormat:currentUser.momentFormatDate}}
                    </td>
                </tr>
            </tbody>
        </table>

        <pagination class="pagination-sm"
            data-total-items="itemCount"
            data-ng-model="currentPage"
            data-items-per-page="itemsPerPage"
            data-max-size="10"
            data-boundary-links="true"
            data-rotate="false"
        ></pagination>
    </div>
</div>